# API Pentesting Checklist

## Information Gathering

- [ ] Identify the API's purpose, business logic, and functionality.
- [ ] Enumerate API endpoints and methods (GET, POST, PUT, DELETE, etc.).
- [ ] Gather information about API versioning and changes.
- [ ] Discover hidden or undocumented endpoints using fuzzing and brute force.
- [ ] Obtain API documentation, if available, and review it for insights.
  - **Tools:** [Swagger](https://swagger.io/), [Postman](https://www.postman.com/)
  - **Commands:** `curl`, `wget`

## Authentication Testing

- [ ] Test API authentication mechanisms, such as API keys, OAuth, JWT, or basic authentication.
- [ ] Verify if authentication tokens or credentials are securely stored on the client side.
- [ ] Test for missing or weak authentication, including default credentials.
- [ ] Assess multi-factor authentication (MFA) if used.
  - **Tools:** [Burp Suite](https://portswigger.net/burp), [JWT.io Debugger](https://jwt.io/)
  - **Commands:** `curl`, `jwtdecode`

## Authorization Testing

- [ ] Test role-based access control (RBAC) and authorization mechanisms.
- [ ] Check if users can access resources they shouldn't have permissions for.
- [ ] Test for horizontal privilege escalation by manipulating user roles.
- [ ] Verify proper enforcement of access controls, such as admin vs. regular user.
  - **Tools:** [ZAP](https://www.zaproxy.org/), [OWASP Amass](https://github.com/OWASP/Amass)
  - **Commands:** `curl`

## Input Validation

- [ ] Test for input validation and output encoding to prevent injection attacks.
- [ ] Check for SQL injection, Cross-Site Scripting (XSS), and other injection vulnerabilities.
- [ ] Verify if API endpoints properly validate and sanitize user inputs.
- [ ] Assess file upload endpoints for malicious file uploads.
  - **Tools:** [OWASP ZAP](https://www.zaproxy.org/), [SQLMap](https://github.com/sqlmapproject/sqlmap)
  - **Commands:** `curl`

## Data Exposure

- [ ] Test for sensitive data exposure through API responses.
- [ ] Verify if the API enforces proper data encryption in transit (HTTPS).
- [ ] Check for information disclosure in error messages.
- [ ] Ensure that data, especially personally identifiable information (PII), is redacted.
  - **Tools:** [Burp Suite](https://portswigger.net/burp), [nmap](https://nmap.org/)
  - **Commands:** `curl`

## Rate Limiting and Resource Exhaustion

- [ ] Test rate limiting and resource exhaustion controls.
- [ ] Check if the API is vulnerable to brute force attacks or denial-of-service (DoS) attacks.
- [ ] Test for API rate limiting bypass techniques.
- [ ] Verify if anti-automation mechanisms are in place.
  - **Tools:** [Hydra](https://tools.kali.org/password-attacks/hydra), [Siege](https://www.joedog.org/siege-home/)
  - **Commands:** `hydra`, `siege`

## JWT and OAuth Testing

- [ ] Test JSON Web Tokens (JWT) security, including signature validation.
- [ ] Check for OAuth vulnerabilities, such as authorization code, implicit grant, and client credentials issues.
- [ ] Verify if OAuth tokens are securely managed, rotated, and revoked.
- [ ] Assess OAuth token scope and permissions.
  - **Tools:** [OAuth2.0 Debugger](https://oauthdebugger.com/), [JWT.io Debugger](https://jwt.io/)
  - **Commands:** `curl`

## API Rate Limiting

- [ ] Test API rate limiting policies for different user roles.
- [ ] Verify if rate limiting is consistently applied across API endpoints.
- [ ] Check for bypasses or weaknesses in rate limiting controls.
- [ ] Test for API rate limiting abuse and scenarios.
  - **Tools:** [Burp Suite](https://portswigger.net/burp), [Siege](https://www.joedog.org/siege-home/)
  - **Commands:** `curl`, `siege`

## Error Handling

- [ ] Test how the API handles errors and exceptions.
- [ ] Check if error messages reveal sensitive information or internal details.
- [ ] Verify that proper HTTP status codes are returned for different error scenarios.
- [ ] Assess if error messages are consistent and not overly verbose.
  - **Tools:** [OWASP ZAP](https://www.zaproxy.org/), [nmap](https://nmap.org/)
  - **Commands:** `curl`

## Webhooks and Callbacks

- [ ] Test webhooks and callback mechanisms.
- [ ] Check for security vulnerabilities in callback URLs, such as SSRF or unauthorized callbacks.
- [ ] Verify if callbacks are properly authenticated and validated.
- [ ] Test for replay attacks or callback abuse.
  - **Tools:** [Webhook.site](https://webhook.site/), [RequestBin](https://requestbin.com/)
  - **Commands:** `curl`





![image](https://github.com/m14r41/PENTESTING/blob/main/API%20Pentesting/SRC/methods.png)
 
![image](https://github.com/m14r41/PENTESTING/assets/95265573/c9c884d0-55bb-4196-a6c2-6fdb6a816060)

