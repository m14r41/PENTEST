## Amazing Resources

| 1. | https://www.cyberark.com/resources/threat-research-blog/thick-client-penetration-testing-methodology |
| -- | ---------------------------------------------------------------------------------------------------- |
| 2. |  https://infosecwriteups.com/thick-client-pentest-modern-approaches-and-techniques-part-1-7bb0f5f28e8e                                                                                             |
|  3  |  https://payatu.com/blog/thick-client-penetration-testing/                                                                                                    |




---

> **List of some known vulnerabilities we might found in Thick Client application.**

| S.N | vulnerabiliyt           |
|-----|-------------------------|
| 1.  | Sensitive data leakage  |
| 2.  | DLL Hijacking           |
| 3.  | Improper Error Handling |
| 4.  | Injection               |
| 5.  | Reverse Engineering     |
| 6.  | Session Management      |
| 7.  | Insecure Storage        |
| 8.  | SSL/TLS                 |
| 9.  | Business Logic          |
| 10. | Weak encryption checks  |



---

> **List of some known tools we will be using during Thick Client Pentest.**

| S.N | Tools                                |
|-----|--------------------------------------|
| 1.  | Echo mirage                          |
| 2.  | Procmon                              |
| 3.  | Strings.exe                          |
| 4.  | Sysinternals Suite                   |
| 5.  | Nmap                                 |
| 6.  | Testssl                              |
| 7.  | Process Hacker                       |
| 8.  | Dnspy/ Dot Peek/ VB decompiler       |
| 9.  | Metasploit (To create Mal. DLL file) |
| 10. | Fiddler/Burpsuite                    |
| 11. | Wireshark                            |
| 12. | Ollydbg                              |
| 13. | .Net Reflector                       |
| 14. | Winhex                               |


**Commaon programming laguage used for Thick Client application development**

| S.N | Language              |
|-----|-----------------------|
| 1.  | dot .Net              |
| 2.  | Java                  |
| 3.  | C/C++                 |
| 4.  | Microsoft Silverlight |

## Thick Client Application Security Testing

> Thick client applications are any that are installed locally on a user's desktop/laptop. These applications are full-featured and can run independently without being connected to the Internet, unlike web applications, which need to be connected to the Internet all the time. Some examples of thick client applications are:

1.  Computer games like Call of Duty, Uncharted, etc.
2.  Web browsers
3.  Music players
4.  Video and chat tools like Teams, Zoom, Slack, etc.

>**Thick client applications come in two flavors**

| Two-Tier Applications         | Three-Tier Applications     |
|---|------------|
| These are self-contained applications where the server/database and client are installed on the same machine or same internal network. Traffic from the thick client goes to the server directly without passing through an intermediary like the Internet or application server | These applications can connect over the Internet and have their business logic processed by an application server. The thick client resides on the user's desktop while the application server and database might be present elsewhere. Network connections and interactions typically usually happen using HTTP/S protocols, which allow for traditional requests / responses to occur. In addition, some thick clients may use alternate protocols like FTP/S, TCP, UDP, etc |
---



-   [  Echo Mirage](https://sourceforge.net/projects/echomirage.oldbutgold.p/)  ‚Äì This is the Swiss army knife of thick client testing tools. Echo Mirage, which is similar to Burp / OWASP Zap, allows for traffic between client and server to be intercepted. Unlike Burp, there is no certificate to be installed locally (even though Echo Mirage can intercept encrypted traffic between client and server).
-   [Sysinternals Suite](https://download.sysinternals.com/files/SysinternalsSuite.zip)  ‚Äì This comprehensive suite of tools from Microsoft allows testers to see what processes are spawned by the thick client application and the registry entries created or accessed by the thick client. Procmon and Regmon are two of the common tools in Sysinternals used to check for processes and registry entries. The suite also contains many other tools.
-   [Mallory](https://github.com/intrepidusgroup/mallory)  ‚Äì This Linux-based tool can be used to capture TCP / UDP traffic.
-   [dnspy](https://github.com/dnSpy/dnSpy/releases/download/v6.1.8/dnSpy-net-win64.zip)  /  [Dot Peek](https://www.jetbrains.com/decompiler/download/download-thanks.html?platform=windowsWeb)  /  [.Net Reflector](https://www.red-gate.com/products/dotnet-development/reflector/)  ‚Äì .Net based thick clients may have hardcoded data or source code which may not be obfuscated. dnSpy and Dot Peek allow for deobfuscation and inspection of DLL files. .Net Reflector is a commercial tool which allows for decompilation of DLLs and for debugging.
-   Burp Invisible Mode ‚Äì Burp has an invisible mode which allows for capturing traffic for proxy-unaware thick clients. This can be done by binding the loopback address to the remote domain / IP address. BAPP has  [NoPE](https://github.com/summitt/Burp-Non-HTTP-Extension)  Burp Extension, which is a good add-on for working with thick client traffic.
-   [Java Snoop](http://code.google.com/p/javasnoop/downloads/list)  ‚Äì For Java thick clients, this allows for interception of any method in the JVM. Java Snoop works on existing Java processes by attaching itself to the running process.
-   Text Editors ‚Äì Thick clients frequently leverage configuration files stored within the local system in plain text, often as .config or .ini files. Text editors can be used to inspect these config files for any sensitive content, such as hardcoded passwords, access tokens and keys, etc.
-   [Ollydbg](https://www.ollydbg.de/odbg110.zip)  /  [IDA Pro](https://hex-rays.com/ida-free/#download)  ‚Äì Useful for reverse-engineering EXE and DLL files. Hex Editors and Strings are other tools which can be useful when searching for strings / keywords.
-   [Nmap](https://nmap.org/download)  ‚Äì Useful for inspecting ports used by the thick client.
-   [Spy++](https://docs.microsoft.com/en-us/visualstudio/debugger/introducing-spy-increment?view=vs-2022)  ‚Äì This ships with Visual Studio and can be used for GUI Tampering.

| S.N | Credits|
|-----|-------|
| 1   | [Viraj Moto](https://medium.com/@virajmota38?source=post_page-----7bb0f5f28e8e--------------------------------) |
| 2   | [optiv.com](https://www.optiv.com/insights/source-zero/blog/thick-client-application-security-testing)          |


---

 S.N  | ON the basis of  | thin client  | thick client |  
---|---|---|---|
 1.  | basic  | thin client is a lightweight computer that relies on the resources of the host computer.  | the thick client relies lightly upon the server and provides rich functionality. | 
 2.  | datastore  | in thin client, data is stored in servers.  | in thick client, data is stored locally. |  
 3.  | network latency  | in thin client, a fast and robust network connection is required.  | it can work with a slow network connection. |  
 4.  | offline working  | there is no offline working.  | offline working is possible in thick client. |  
 5.  | deployment  | the deployment is easier in thin client.  | unlike the thin client, the deployment in thick client is expensive. |  
 6.  | data validation  | in thin client, the data verification is done at server side.  | in thick client, the data verification is done at client side. |  
 7.  | local resources  | it generally consumes less local resources.  | unlike thin client, it consumes more local resources. |  
 8.  | security  | in terms of security, they are more secure than thick clients as they have fewer security threats.  | in terms of security, they are less secure than thin clients as they have more security threats. | 

---

# THICK CLIENT

# PENTESTING CHECKLIST

```
OWASPBased Checklist üåüüåü
80 + Test Cases üöÄüöÄ
```
### INFORMATION GATHERING

**1. Information Gathering**

## ‚òê Find out the application architecture (two-tieror three-tier)

## ‚òê Find out the technologies used (languages and frameworks)

## ‚òê Identify network communication

## ‚òê Observe the application process

## ‚òê Observe each functionality and behavior of theapplication

## ‚òê Identify all the entry points

## ‚òê Analyze the security mechanism (authorization andauthentication)

**2. Tools Used**

## ‚òê CFF Explorer

## ‚òê Sysinternals Suite

## ‚òê Wireshark

## ‚òê PEid

## ‚òê Detect It Easy (DIE)

## ‚òê Strings


```
https://hariprasaanth.blogspot.com/
```
### GUI TESTING

**1. Test For GUI Object Permission**

## ‚òê Display hidden form object

## ‚òê Try to activate disabled functionalities

## ‚òê Try to uncover the masked password

**2. Test GUI Content**

## ‚òê Look for sensitive information

**3. Test For GUI Logic**

## ‚òê Try for access control and injection-based vulnerabilities

## ‚òê Bypass controls by utilizing intended GUI functionality

## ‚òê Check improper error handling

## ‚òê Check weak input sanitization

## ‚òê Try privilege escalation (unlocking admin featuresto normal users)

## ‚òê Try payment manipulation

**4. Tools Used**

## ‚òê UISpy

## ‚òê Winspy++

## ‚òê Window Detective

## ‚òê Snoop WPF


```
https://hariprasaanth.blogspot.com/
```
### FILE TESTING

**1. Test For Files Permission**

## ‚òê Check permission for each and every file and folder

**2. Test For File Continuity**

## ‚òê Check strong naming

## ‚òê Authenticate code signing

**3. Test For File Content Debugging**

## ‚òê Look for sensitive information on the file system(symbols, sensitive

```
data, passwords, configurations)
```
## ‚òê Look for sensitive information on the config file

## ‚òê Look for Hardcoded encryption data

## ‚òê Look for Clear text storage of sensitive data

## ‚òê Look for side-channel data leakage

## ‚òê Look for unreliable log

**4. Test For File And Content Manipulation**

## ‚òê Try framework backdooring

## ‚òê Try DLL preloading

## ‚òê Perform Race condition check

## ‚òê Test for Files and content replacement

## ‚òê Test for Client-side protection bypass using reverseengineering

**5. Test For Function Exported**

## ‚òê Try to find the exported functions

## ‚òê Try to use the exported functions without authentication


```
https://hariprasaanth.blogspot.com/
```
**6. Test For Public Methods**

## ‚òê Make a wrapper to gain access to public methodswithout authentication

**7. Test For Decompile And Application Rebuild**

## ‚òê Try to recover the original source code, passwords,keys

## ‚òê Try to decompile the application

## ‚òê Try to rebuild the application

## ‚òê Try to patch the application

**8. Test For Decryption And DE obfuscation**

## ‚òê Try to recover original source code

## ‚òê Try to retrieve passwords and keys

## ‚òê Test for lack of obfuscation

**9. Test For Disassemble and Reassemble**

## ‚òê Try to build a patched assembly

**10. Tools Used**

## ‚òê Strings

## ‚òê dnSpy

## ‚òê Procmon

## ‚òê Process Explorer

## ‚òê Process Hacker


```
https://hariprasaanth.blogspot.com/
```
### REGISTRY TESTING

**1. Test For Registry Permissions**

## ‚òê Check read access to the registry keys

## ‚òê Check to write access to the registry keys

**2. Test For Registry Contents**

## ‚òê Inspect the registry contents

## ‚òê Check for sensitive info stored on the registry

## ‚òê Compare the registry before and after executingthe application

**3. Test For Registry Manipulation**

## ‚òê Try for registry manipulation

## ‚òê Try to bypass authentication by registry manipulation

## ‚òê Try to bypass authorization by registry manipulation

**4. Tools Used**

## ‚òê Regshot

## ‚òê Procmon

## ‚òê Accessenum


```
https://hariprasaanth.blogspot.com/
```
### NETWORK TESTING

**1. Test For Network**

## ‚òê Check for sensitive data in transit

## ‚òê Try to bypass firewall rules

## ‚òê Try to manipulate network traffic

**2. Tools Used**

## ‚òê Wireshark

## ‚òê TCPview

### ASSEMBLY TESTING

**1. Test For Assembly**

## ‚òê Verify Address Space Layout Randomization (ASLR)

## ‚òê Verify SafeSEH

## ‚òê Verify Data Execution Prevention (DEP)

## ‚òê Verify strong naming

## ‚òê Verify ControlFlowGuard

## ‚òê Verify HighentropyVA

**2. Tools Used**

## ‚òê PESecurity


```
https://hariprasaanth.blogspot.com/
```
### MEMORY TESTING

**1. Test For Memory Content**

## ‚òê Check for sensitive data stored in memory

**2. Test For Memory Manipulation**

## ‚òê Try for memory manipulation

## ‚òê Try to bypass authentication by memory manipulation

## ‚òê Try to bypass authorization by memory manipulation

**3. Test For Run Time Manipulation**

## ‚òê Try to analyze the dump file

## ‚òê Check for process replacement

## ‚òê Check for modifying assembly in the memory

## ‚òê Try to debug the application

## ‚òê Try to identify dangerous functions

## ‚òê Use breakpoints to test each and every functionality

**4. Tools Used**

## ‚òê Process Hacker

## ‚òê HxD

## ‚òê Strings


```
https://hariprasaanth.blogspot.com/
```
### TRAFFIC TESTING

**1. Test For Traffic**

## ‚òê Analyze the flow of network traffic

## ‚òê Try to find sensitive data in transit

**2. Tools Used**

## ‚òê Echo Mirage

## ‚òê MITM Relay

## ‚òê Burp Suite

### COMMON VULNERABILITIES TESTING

**1. Test For Common Vulnerabilities**

## ‚òê Try to decompile the application

## ‚òê Try reverse engineering

## ‚òê Try to test with OWASP WEB Top 10

## ‚òê Try to test with OWASP API Top 10

## ‚òê Test for DLL Hijacking

## ‚òê Test for signature checks (Use Sigcheck)

## ‚òê Test for binary analysis (Use Binscope)

## ‚òê Test for business logic errors

## ‚òê Test for TCP/UDP attacks

## ‚òê Test with automated scanning tools (Use VisualCode Grepper - VCG)



